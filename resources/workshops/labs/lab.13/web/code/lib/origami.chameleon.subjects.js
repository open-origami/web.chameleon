const t="object",e="array",n="function",r="number",o="boolean",i="string",u="undefined",c=".",f=void 0;let s=t=>e=>typeof t[e]!==n,l=t=>e=>typeof t[e]===n,a=t=>t=>"constructor"!==t;function g(g){function d(t){if((t=typeof t===u?g:t)===Object.prototype||t===Array.prototype||t===Function.prototype||t===String.prototype||t===Number.prototype||t===Boolean.prototype||null===t)return[];return[...d(Object.getPrototypeOf(t)),...Object.getOwnPropertyNames(t)].filter((function(t,e,n){return e<=n.indexOf(t)}))}function p(t){return t?t.split(c).reduce((function(t,e){return Array.isArray(t)&&isNaN(e)?t.map((function(t){return t[e]})):t&&t[e]}),g):g}function y(t){const n=p(t);return n instanceof Array?e:typeof n}function b(t){return y(t)===n}function h(t){return y(t)===e}function v(e){return y(e)===t}function m(t){return y(t)===u}function O(t,e){return d().reduce((function(e,n,r){return t(e,g[n],n,g)}),e)}return g=g||{},{at:function(t){if(d().length>t){const e=d()[t];return{key:e,value:p(e)}}},get keys(){return d()},get properties(){return d(g).filter(s(g))},get methods(){return d(g).filter(l(g)).filter(a())},get prototype(){return Object.getPrototypeOf(g)},get:p,set:function(t,e){return t.split(c).reduce((function(t,n,r,o){return t[n]=r<o.length-1?t[n]||{}:e}),g)},has:function(t){return!m(t)},remove:function(t){return t.split(c).reduce((function(t,e,n,r){return n<r.length-1?t?t[e]:f:t&&delete t[e]}),g)},type:y,isFunction:b,isArray:h,isObject:v,isNumber:function(t){return y(t)===r},isBoolean:function(t){return y(t)===o},isString:function(t){return y(t)===i},isPrimitive:function(t){return!(m(t)||v(t)||h(t)||b(t))},isUndefined:m,asArray:function(t){return h(t)?p(t):[p(t)]},asFunction:function(t){return b(t)?p(t):function(){return p(t)}},forEach:function(t){d().forEach((function(e,n){t(g[e],e,g)}))},map:function(t){return O((function(e,n,r){return e[r]=t(n),e}),{})},reduce:O,filter:function(t){return O((function(e,n,r){return t(n)&&(e[r]=n),e}),{})},every:function(t){return O((function(e,n,r){return e&&t(n)}),!0)},some:function(t){return O((function(e,n,r){return e||t(n)}),!1)}}}const d="before",p="after",y="around",b="provided",h="except",v=void 0;function m(t){function e(t){if(t.advisable)return t;const e=function(...n){let r=v;return e.provided.every(t=>t(...n))&&(e.except.some(t=>t(...n))||(r=e.before.reduce((t,e)=>e(...n,t),r),r=e.around.reduce((e,r)=>r(t,...n,e),r),0===e.around.length&&(r=t(...n)),r=e.after.reduce((t,e)=>e(...n,t),r)||r)),r};return e.provided=e.provided||[],e.except=e.except||[],e.before=e.before||[],e.after=e.after||[],e.around=e.around||[],e.advisable=!0,e}function n(e){return function(n){return t.advisable&&(t[e]=t[e].filter((function(t){return t!==n}))),t}}function r(e,n){return n=n||t,function(...t){let r=n(...t);return r===v?r:e(r)}}function o(e){return function(...n){setTimeout((function(){t(...n)}),e||0)}}return t=t||function(){},{fix:function(e){return function(...n){return t.apply(this,n.splice(0,e))}},first:function(...e){return function(...n){return t(...e,...n)}},last:function(...e){return function(...n){return t(...n,...e)}},lCurry:function(){return function e(...n){return n.length>=t.length?t(...n):function(...t){return e(...n,...t)}}()},rCurry:function(){return function e(...n){return n.length>=t.length?t(...n):function(...t){return e(...t,...n)}}()},before:function(n){return(t=e(t)).before.push(n),t},after:function(n){return(t=e(t)).after.push(n),t},around:function(n){return(t=e(t)).around.push(n),t},provided:function(n){return(t=e(t)).provided.push(n),t},except:function(n){return(t=e(t)).except.push(n),t},not:{before:n(d),after:n(p),around:n(y),provided:n(b),except:n(h)},composeWith:r,sequenceWith:function(...t){return t.reduce((function(t,e){return r(e,t)}),t=>t)},fluent:function(e,n){let r=n||function(){};return function(...n){return r(t(...n)),e}},memoize:function(){let e={};return function(...n){return n in e?e[n]:e[n]=t(...n)}},overload:function(...t){return function(...e){return(t.filter((function(t){return t.length===e.length}))[0]||(t=>t))(...e)}},delay:o,forever:function(e){return function(...n){return setInterval((function(){t(...n)}),e||0)}},retry:function(t,e){return function(...t){o(e)(...t)}},defer:function(){return o(0)}}}const O=void 0;function j(t){let e=g(t=(t=t||{}).prototype?t.prototype:t);function n(n,r){return e.isFunction(n)&&(t[n]=t[n].bind(r)),this}function r(e,n){return t[e]=n,this}function o(e){return delete t[e],this}function i(t,e){return e in t&&r(e,t[e]),this}function u(t,e){return i(t,e),j(t).remove(e),this}function c(){return j(Object.getPrototypeOf(t))}function f(e){return Object.getOwnPropertyDescriptor(t,e)}function s(e,n){return function(r,o){return t[r]=m(t[r]).not[e](o),n}}let l={get:function(){return t},bind:n,context:function(e){return g(t).keys.forEach((function(t){n(t,e)})),this},add:r,remove:o,update:function(e,n){return e in t&&r(e,n),this},rename:function(e,n){return e in t&&!(n in t)&&(r(n,t[e]),o(e)),this},copy:i,move:u,mix:function(t,e,r){g(t);const o=r||(t=>t);return g(t).keys.filter(o).filter(t=>"constructor"!==t).forEach((function(r){i(t,r),e&&n(r,e)})),this},clone:function(){return j(Object.assign({},t))},create:function(){return Object.create(t)},copyUp:function(e){return j(c().get()).copy(t,e),this},copyDown:function(t){return i(c().get(),t),this},moveUp:function(e){return j(c().get()).move(t,e),this},moveDown:function(t){return u(c().get(),t),this},prototype:function(e){return e==O?c():function(e){return e=e.prototype?e.prototype:e,Object.setPrototypeOf(t,e),j(t)}(e)},before:function(n,r){return e.isFunction(n)?t[n]=m(t[n]).before(r):function(e,n){n.get=n.get||function(){},n.set=n.set||function(){};let r=f(e);Object.defineProperty(t,e,{get:function(){return n.get(),r.get()},set:function(t){n.set(t),r.set(t)}})}(n,r),this},after:function(n,r){return e.isFunction(n)?t[n]=m(t[n]).after(r):function(e,n){n.get=n.get||function(){},n.set=n.set||function(){};let r=f(e);Object.defineProperty(t,e,{get:function(){let t=n.get();return r.get(),t},set:function(t){r.set(t),n.set(t)}})}(n,r),this},around:function(e,n){return t[e]=m(t[e]).around(n),this},provided:function(e,n){return t[e]=m(t[e]).provided(n),this},except:function(e,n){return t[e]=m(t[e]).except(n),this},property:function(e,n){return n?(function(e,n){Object.defineProperty(t,e,n)}(e,n),this):f(e)},delegate:function(e,n){return t[e]=function(...r){let o=n[e].call(t,...r);return o===n?this:o},this},forward:function(e,n){return t[e]=function(...t){let r=n[e].call(n,...t);return r===n?this:r},this},fProxy:function(){let n={};return e.keys.forEach((function(r){e.isFunction(r)&&(n[r]=function(...e){let o=t[r](...e);return o===t?n:o})})),n},dProxy:function(n){let r={};return e.keys.forEach((function(o){e.isFunction(o)&&(r[o]=function(...e){let i=t[o].apply(n,e);return i===t?r:i})})),r},not:{}};return l.not.before=s("before",l),l.not.after=s("after",l),l.not.around=s("around",l),l.not.provided=s("provided",l),l.not.except=s("except",l),l}const L="get",P="set",k="add",x="remove";const E="get",C="set",w="remove";function F(t){let e={},n=function(t){let e=j(t),n=new WeakMap;function r(t){if(n.has(t))return n.get(t);{function e(...e){e.pop(),t(...e)}return n.set(t,e),e}}return{bind:function(t,n){let o=r(n);t===P?(e.after(k,o),e.after(P,o)):e.after(t,o)},unbind:function(n,o){let i=o&&r(o);n===P?(o&&e.not.after(k,i),o&&e.not.after(P,i),!o&&(t[k].after=[]),!o&&(t[P].after=[])):(o&&e.not.after(n,i),!o&&(t[n].after=[]))},reset:function(){t[L].after=[],t[P].after=[],t[k].after=[],t[x].after=[]}}}(t);return e.get=function(t){return n.bind(E,t),e},e.set=function(t){return n.bind(C,t),e},e.remove=function(t){return n.bind(w,t),e},e.reset=n.reset,e.not={},e.not.get=function(t){return n.unbind(E,t),e},e.not.set=function(t){return n.unbind(C,t),e},e.not.remove=function(t){return n.unbind(w,t),e},e}const{isArray:S}=Array;function D(){let t=window,e=(t.Origami=t.Origami||{},t.Origami.Whale=t.Origami.Whale||{},t.Origami.Whale.Store=t.Origami.Whale.Store||function(t){let e=new Map,n=t||new Map,r={config:function(t){return t.store&&(e=new Map(Object.entries(t.store))),t.parent&&(n=t.parent),this},get:function(t){let r=e.get(t),o=n.get(t);return r&&r||o&&o||r},set:function(t,n){return e.set(t,n),this},add:function(t,n){let r=e.get(t);return S(r)?e.set(t,[...r,n]):e.set(t,[n]),this},keys:function(){let t=new Set,r=e.keys(),o=n.keys();for(let e of o)t.add(e);for(let e of r)t.add(e);return[...t]},has:function(t,n){let r=e.get(t);return S(r)?r.includes(n):void 0!==r},remove:function(t,n){let r=t=>void 0!==t;return r(t)&&r(n)&&function(t,n){let r=e.get(t),o=S(r),i=o&&r.filter(t=>t!==n);o&&e.set(t,i)}(t,n),r(t)&&!r(n)&&function(t){e.delete(t)}(t),!r(t)&&!r(n)&&e.clear(),this}};return r.hooks=F(r),r}(),t.Origami.Whale.Store);return{get:function(t){return e.get(t)},set:function(t,n){e.set(t,n)},keys:function(){return e.keys()},remove:function(t){e.remove(t)}}}const W=function(){let t=D();return{key:function(e){return t.get(e)},keys:function(){return t.keys()},define:function(e){for(let n in e){let r=e[n];t.set(n,r)}return this},undefine:function(e){if(e)for(let n in e)t.remove(n);else t.remove();return this}}}();var A={"Logger.Labels.Debug":"[DEBUG]","Logger.Labels.Info":" [INFO]","Logger.Labels.Warn":" [WARN]","Logger.Labels.Error":"[ERROR]","Logger.Labels.Fatal":"[FATAL]","Logger.Levels.Debug":1,"Logger.Levels.Info":2,"Logger.Levels.Warn":3,"Logger.Levels.Error":4,"Logger.Levels.Fatal":5,"Logger.Config.Format":"@Label @Target @Prefix - @Message","Logger.Config.Prefix":"","Logger.Config.Level":3};var I={install:function(){W.define(A)},uninstall:function(){W.undefine(A)}};function M(t,e){return function(n,...r){let o=W.key("Logger.Config.Level");n>=(t.level||o)&&e(n,...r)}}const N=W.key("Logger.Labels.Debug"),R=W.key("Logger.Labels.Info"),T=W.key("Logger.Labels.Warn"),U=W.key("Logger.Labels.Error"),B=W.key("Logger.Labels.Fatal"),K="",q=" ",z=[N,R,T,U,B];function G(t,e){return function(n,...r){let o=W.key("Logger.Config.Format")||K,i=W.key("Logger.Config.Prefix")||K,u=(W.key("Logger.Config.Level"),t.level,r.join(q)),c=z[n-1],f=t.Key,s=o;s=(s=(s=(s=s.replace("@Label",c)).replace("@Prefix",i)).replace("@Target",f)).replace("@Message",u),e(n,s)}}const H=console;function J(t,e){return function(t,...n){H.log(...n),e(t,...n)}}function Q(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function V(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const X=W.key("Logger.Levels.Debug"),Y=W.key("Logger.Levels.Info"),Z=W.key("Logger.Levels.Warn"),$=W.key("Logger.Levels.Error"),_=W.key("Logger.Levels.Fatal");function tt(t,e){let n=e||{},r=n.filters,o=function(t){let e=[];return{filter:function(t){return(0,Array.isArray)(t)&&(e=[...e,...t]),(t=>"function"==typeof t)(t)&&(e=[...e,t]),this},create:function(){let n=[...e].reverse(),r=function(){};return function(...e){return n.reduce((function(e,n){return n(t,e)}),r)(...e)}}}}(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Q(n,!0).forEach((function(e){V(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Q(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},n,{Key:t})).filter(M).filter(G).filter(J).filter(r).create();return{debug:function(...t){o(X,...t)},info:function(...t){o(Y,...t)},warn:function(...t){o(Z,...t)},fatal:function(...t){o(_,...t)},error:function(...t){o($,...t)}}}var et={"Core.Id":"Core.Id","Core.Family":"Core.Family","Core.Family.Component":"Component","Core.Family.Extension":"Extension","Core.Family.Model":"Model","Core.Extensions.Pending":"Core.Extensions.Pending","Core.Extensions.Installed":"Core.Extensions.Installed"},nt={"Extension.Model":"Extension.Model","Extension.Provider":"Extension.Provider"};const rt="origami.chameleon",ot="Package successfully installed",it="Package successfully uninstalled";var ut=function(){const t=tt(rt);return{install:function(){W.define(et),W.define(nt),t.info(ot)},uninstall:function(){W.undefine(et),W.undefine(nt),t.info(it)}}}(),ct={"Extension.Subject.Points":"Extension.Subject.Points"};const ft="origami.chameleon.subjects",st="Package successfully installed",lt="Package successfully uninstalled";var at=function(){const t=tt(ft);return{install:function(){W.define(ct),t.info(st)},uninstall:function(){W.undefine(ct),t.info(lt)}}}();function gt(t){return function(e){return t(e)}}function dt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function pt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}I.install(),ut.install(),at.install();const{isArray:yt}=Array;function bt(t){let e={},n=g(e),r=g(t);let o={config:function(t){return r=t.parent||r,e=t.store||e,n=g(e),this},get:function(t){return n.has(t)?n.isObject(t)?function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?dt(n,!0).forEach((function(e){pt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):dt(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},r.get(t),{},n.get(t)):n.get(t):r.get(t)},set:function(t,e){return n.set(t,e),this},add:function(t,e){let r=n.get(t);return yt(r)?n.set(t,[...r,e]):n.set(t,[e]),this},keys:function(t){let e=!!t,r=n.has(t);return e&&r?g(n.get(t)).keys:g(n.get()).keys},has:function(t,e){let r=n.get(t);return yt(r)?r.includes(e):void 0!==r},remove:function(t,e){let r=t=>void 0!==t;function o(t){n.remove(t)}return r(t)&&r(e)&&function(t,e){let r=n.get(t),o=yt(r),i=o&&r.filter(t=>t!==e);o&&n.set(t,i)}(t,e),r(t)&&!r(e)&&o(t),!r(t)&&!r(e)&&function(){let t=n.keys;for(let e of t)o(e)}(),this}};return o.hooks=F(o),o}const ht="class",vt="object";function mt(t){function e(t){return t.toString().startsWith(ht)}return{get object(){return function(t){return e(t)?t.prototype:t}(t)},get class(){return function(t){return e(t)?t:Reflect.getPrototypeOf(t).constructor}(t)},get isObject(){return function(t){return typeof t===vt}(t)},get isClass(){return e(t)}}}const Ot=window;var jt=(Ot.Origami=Ot.Origami||{},Ot.Origami.Chameleon=Ot.Origami.Chameleon||{},Ot.Origami.Chameleon.Store=Ot.Origami.Chameleon.Store||new WeakMap,Ot.Origami.Chameleon.Store);function Lt(t){return At(t).registry}const Pt=W.key("Core.Extensions.Pending");let kt=t=>mt(t).isObject,xt=t=>t;function Et(t){return function(e){return{install:function(n){if(kt(e))t(e).install(n);else{Lt(xt(e)).add(Pt,n)}return this},uninstall:function(n){if(kt(e))t(e).uninstall(n);else{Lt(xt(e)).remove(Pt,n)}return this}}}}const Ct=W.key("Core.Extensions.Installed");function wt(t){let e=Lt(t);function n(t){let n=e.get(Ct)||[];return t?n.find((t=>e=>e.class===t)(t)):n}function r(t){return!!n(t)}return{create:function(o){if(r(o))return n(o);{let n=function(t){return{create:function(e){let n=new e(t),r=!0;return{get core(){return t},get class(){return e},get provider(){return n},isOn:()=>r,on(){r=!0},off(){r=!1}}}}}(t).create(o);return e.add(Ct,n),n}},get:n,has:r,remove:function(t){let r=n(t);r&&e.remove(Ct,r)}}}function Ft(t){return function(e){let n=function(t){return function(e){return wt(t).has(e)}}(e),r=t(e);return{install:function(t){return!n(t)&&r.install(t),this},uninstall:function(t){return n(t)&&r.uninstall(t),this}}}}function St(t){return function(e){let n=wt(e),r=t(e);return{install:function(t){return n.create(t).provider.install(),r.install(t),this},uninstall:function(t){if(n.has(t)){n.get(t).provider.uninstall(),n.remove(t),r.uninstall(t)}return this}}}}const Dt=W.key("Extension.Provider");function Wt(t){return function(e){let n=t(e);function r(t){return Lt(t).has(Dt)}function o(t){return Lt(t).get(Dt)}return{install:function(t){return r(t)&&(t=o(t)),!r(t)&&n.install(t),this},uninstall:function(t){return r(t)&&(t=o(t)),!r(t)&&n.uninstall(t),this}}}}function At(t){return{get registry(){return function(t){let e=mt(t).object,n=jt.get(e)||bt();return jt.set(e,n),n}(t)},get core(){return{get type(){return{}},get dom(){return{}},get reactive(){return{}},get style(){return{}}}},get extensions(){return function(t){let e=function(t){let e=[];return{filter:function(t){return t&&e.push(t),this},create:function(){return[...e].reverse().reduce((function(t,e){return e(t)}),(function(t){return{install(){return this},uninstall(){return this}}}))(t)}}}(t).filter(Et).filter(Wt).filter(Ft).filter(St).create();return{install:function(t){return e.install(t),this},uninstall:function(t){return e.uninstall(t),this}}}(t)}}}function It(t){return At(t).registry}const Mt=W.key("Extension.Subject.Points");function Nt(t){let e=It(t);function n(){return e.get(Mt)||[]}function r(t){let n=(e.get(Mt)||[]).filter(e=>e!==t);e.set(Mt,n)}return{get:n,set:function(t){r(t),e.add(Mt,t)},has:function(t){return n().includes(t)},remove:r}}function Rt(t){return gt((function(e){Nt(e).set(t)}))}const Tt=".";const Ut=W.key("Core.Extensions.Installed");let Bt=t=>t&&t.get&&t.get.isPoint,Kt=t=>t&&!Bt(t)&&"object"==typeof t,qt=t=>t&&!Kt(t)&&"string"==typeof t;function zt(t){return function(e){let n,r,o,i=It(t).get(Ut)||[];return qt(e)&&(n=e),Bt(e)&&(r=e),Kt(e)&&(o=e),n?i.filter((u=n,function(t){return t.subject&&t.subject.points&&t.subject.points.some((function(t){return t.startsWith(u)}))})):r?i.find(function(t){let e=t.get();return function(t){return t.subject&&t.subject.points&&t.subject.points.includes(e)}}(r)):o?i.find(function(t){return function(e){return t===e.provider.ext}}(o)):!e&&i;var u}}function Gt(t){let e,n=function(t,e){const n=[],r=e||Tt;function o(){return n.join(r)}function i(t){return n.push(t),this}return t&&n.push(t),o.isPoint=!0,i.isPoint=!0,{get:o,set:i}}(),r=zt(t),o=new Proxy({},{get(t,i){if(n.set(i),(e=r(n))&&e.isOn())return e.provider.ext;{let t=n.get();if(r(t).length>0)return o}}});return o}const Ht=W.key("Core.Id"),Jt=W.key("Core.Family"),Qt=W.key("Core.Family.Model"),Vt=gt((function(t){let e=t.name,n=Qt;Lt(t).set(Ht,e).set(Jt,n)})),Xt=t=>t.provider.class,Yt=t=>t;function Zt(t){let e=zt(t);return{create:function(t){let n=e(t),r=Xt(n),o=Yt(t),i=Nt(r);n.subject={},n.subject.locus=o,n.subject.points=i.get(),n.on()},destroy:function(t){let n=e(t);n.subject.locus=void 0,n.subject.points=[],n.off()}}}var $t;let _t=tt("origami.chameleon.subjects"),te=Vt($t=class{constructor(t){this.subject=Zt(t)}install(t){this.subject.create(t),_t.info("Extension successfully installed")}uninstall(t){this.subject.destroy(t),_t.info("Extension successfully uninstalled")}})||$t;export{Rt as Point,te as Subject,Gt as Utils};